{% if files -%}
You will be provided with 1) a partial code base, 2) an issue statement explaining a problem to resolve, and 3) a patch addressing the issue.
{% else -%}
You will be provided with 1) an issue statement explaining a problem to resolve, and 2) a patch addressing the issue.
{% endif -%}
<issue>
{{ problem_statement }}
</issue>
{% if files -%}
<code>
{% for file_path, file_content in files.items() -%}
[start of {{ file_path }}]
{% if add_line_numbers -%}
{% for line in file_content.split('\n') -%}
{{ "{:4d}".format(loop.index) }} {{ line }}
{% endfor -%}
{% else -%}
{{ file_content }}
{% endif -%}
[end of {{ file_path }}]
{% endfor -%}
</code>
{% endif -%}
<patch>
{{ patch }}
</patch>
I need you to comprehensively review the above patch with respect to the given issue from multiple dimensions such as functional implementation, code quality, and defects. Generate a report in the following format.
<review>
## Function
Briefly describe the main purpose and implemented functionality of this patch. Specifically, does this patch address the issue?

## Complexity
Is the patch more complex than it should be? Check it at every level - lines, functions, classes.

## Style
Does the patch follow the programming conventions of the original code? Does it pick good names for newly introduced variables, functions, classes, and files?

## Documentation
Does the patch provide clear and necessary comments? If the patch changes how users build, test, interact with, or release code, does it also update associated documentation?

## Defects
If there are any defects in the patch, point out their locations (file path and line number) and provide improvement suggestions in the following format:
<defect>
file_path: file path of defect 1 in the patch
line: line number of defect 1 in the patch
suggestion: suggestion for defect 1
</defect>
<defect>
file_path: file path of defect 2 in the patch
line: line number of defect 2 in the patch
suggestion: suggestion for defect 2
</defect>
...
Note:
- If there is no defect, output "None" in this section.
</review>