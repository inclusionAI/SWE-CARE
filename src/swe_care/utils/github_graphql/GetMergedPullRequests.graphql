query GetMergedPullRequests($owner: String!, $name: String!, $prCursor: String, $maxNumber: Int!) {
  repository(owner: $owner, name: $name) {
    nameWithOwner
    pullRequests(states: [MERGED], first: $maxNumber, after: $prCursor, orderBy: {field: CREATED_AT, direction: DESC}) {
      totalCount
      pageInfo {
        hasNextPage
        endCursor
      }
      nodes {
        id
        title
        body
        number
        url
        author {
          login
        }
        createdAt
        mergedAt
        mergedBy {
          login
        }
        baseRefOid
        baseRefName
        headRefOid
        headRefName
        changedFiles

        labels(first: 10) {
          totalCount
          pageInfo {
            hasNextPage
            endCursor
          }
          nodes {
            name
          }
        }

        commits(first: 10) {
          totalCount
          pageInfo {
            hasNextPage
            endCursor
          }
          nodes {
            commit {
              oid
              message
              changedFilesIfAvailable
              authoredDate
              author {
                user {
                  login
                }
              }
              committedDate
              committer {
                user {
                  login
                }
              }
              parents(first: 2) {
                nodes {
                  oid
                }
              }
            }
          }
        }

        reviews(first: 10) {
          totalCount
          pageInfo {
            hasNextPage
            endCursor
          }
          nodes {
            id
            author {
              login
            }
            state
            body
            submittedAt
            updatedAt
            commit {
              oid
            }
            comments(first: 10) {
              totalCount
              pageInfo {
                hasNextPage
                endCursor
              }
              nodes {
                id
                author {
                  login
                }
                body
                createdAt
                updatedAt
                path
                diffHunk
                line
                startLine
                originalLine
                originalStartLine
                replyTo {
                    id
                }
                isMinimized,
                minimizedReason,
                commit {
                  oid
                }
                originalCommit {
                    oid
                }
              }
            }
          }
        }

        reviewThreads(first: 10) {
          totalCount
          pageInfo {
            hasNextPage
            endCursor
          }
          nodes {
            id
            isResolved
            isOutdated
            isCollapsed
            path
            startLine
            originalLine
            diffSide
            startDiffSide
            resolvedBy {
              login
            }
            comments(first: 10){
              totalCount
              pageInfo {
                hasNextPage
                endCursor
              }
              nodes {
                id
              }
            }
          }
        }

        closingIssuesReferences(first: 10) {
          totalCount
          pageInfo {
            hasNextPage
            endCursor
          }
          nodes {
            id
            number
            url
            title
            body
            state
            labels(first: 10) {
              totalCount
              pageInfo {
                hasNextPage
                endCursor
              }
              nodes {
                name
              }
            }
            comments(first: 10) {
              totalCount
              pageInfo {
                hasNextPage
                endCursor
              }
              nodes {
                id
                author {
                  login
                }
                body
                createdAt
                updatedAt
              }
            }
          }
        }
      }
    }
  }
}